# clashctl - ç®€æ´ä¼˜å…ˆçš„ TUI Clash æ§åˆ¶å™¨

<div align="center">

**ç®€å•æ¨¡å¼ 3 åˆ†é’Ÿä¸Šæ‰‹ â€¢ ä¸“å®¶æ¨¡å¼æ— é™å¯èƒ½**

[![Build Status](https://img.shields.io/badge/build-passing-brightgreen)]()
[![Rust](https://img.shields.io/badge/rust-1.70+-orange)]()
[![License](https://img.shields.io/badge/license-MIT-blue)]()

[åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§) â€¢ [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹) â€¢ [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—) â€¢ [å¿«æ·é”®](#å¿«æ·é”®é€ŸæŸ¥) â€¢ [å¼€å‘æ–‡æ¡£](#å¼€å‘æ–‡æ¡£)

</div>

---

## é¡¹ç›®ç®€ä»‹

**clashctl** æ˜¯ä¸€ä¸ªä»¥"ç®€å•ä¼˜å…ˆ"ä¸ºæ ¸å¿ƒç†å¿µçš„ Clash TUI æ§åˆ¶å™¨ã€‚é€šè¿‡ Clash External Controller API ä¸ Clash å†…æ ¸é€šä¿¡ï¼Œä¸ºç”¨æˆ·æä¾›ç›´è§‚ã€é«˜æ•ˆçš„ç»ˆç«¯ç•Œé¢ã€‚

### ä¸ºä»€ä¹ˆé€‰æ‹© clashctlï¼Ÿ

- ğŸ¯ **ç®€å•æ¨¡å¼ä¼˜å…ˆ** - 3 åˆ†é’Ÿä¸Šæ‰‹ï¼Œéšè—å¤æ‚åº¦
- âš¡ **éé˜»å¡å¼‚æ­¥** - UI æ°¸ä¸å¡é¡¿ï¼Œæµç•…ä½“éªŒ
- ğŸ¨ **çµæ´»çš„ Preset ç³»ç»Ÿ** - é€‚åº”ä¸åŒä½¿ç”¨åœºæ™¯
- ğŸ’¾ **é…ç½®æŒä¹…åŒ–** - è‡ªåŠ¨ä¿å­˜ï¼Œæ— éœ€é‡å¤é…ç½®
- ğŸ”„ **å®æ—¶ç›‘æ§** - è¿æ¥çŠ¶æ€ã€èŠ‚ç‚¹å»¶è¿Ÿä¸€ç›®äº†ç„¶
- ğŸ›¡ï¸ **å®‰å…¨é˜²æŠ¤** - Strict æ¨¡å¼é˜²æ­¢è¯¯æ“ä½œ

---

## åŠŸèƒ½ç‰¹æ€§

### âœ… å·²å®ç°åŠŸèƒ½

#### æ ¸å¿ƒåŠŸèƒ½
- âœ… **Home é¡µé¢** - çŠ¶æ€æ¦‚è§ˆã€åœºæ™¯åˆ‡æ¢ã€èŠ‚ç‚¹æµ‹é€Ÿ
- âœ… **Routes é¡µé¢** - çº¿è·¯/èŠ‚ç‚¹ç®¡ç†ã€æ‰¹é‡æµ‹é€Ÿã€ä¸€é”®åˆ‡æ¢
- âœ… **Rules é¡µé¢** - è§„åˆ™ç®¡ç†ã€ç™½åå•/é»‘åå•ã€è§„åˆ™æœç´¢
- âœ… **Connections é¡µé¢** - å®æ—¶è¿æ¥ç›‘æ§ã€æµé‡ç»Ÿè®¡ã€è¿æ¥ç®¡ç†
- âœ… **Settings é¡µé¢** - é…ç½®å¯¼å…¥/å¯¼å‡ºã€è®¾ç½®ç®¡ç†

#### é«˜çº§åŠŸèƒ½
- âœ… **åŒæ¨¡å¼ç³»ç»Ÿ** - Simple æ¨¡å¼ï¼ˆåˆå­¦è€…ï¼‰/ Expert æ¨¡å¼ï¼ˆé«˜çº§ç”¨æˆ·ï¼‰
- âœ… **Preset ç³»ç»Ÿ** - Default / Work / Strict / Expert å››ç§é¢„è®¾
- âœ… **èŠ‚ç‚¹æ”¶è—** - æ ‡è®°å¸¸ç”¨èŠ‚ç‚¹ï¼Œå¿«é€Ÿè¯†åˆ«
- âœ… **é…ç½®ç®¡ç†** - YAML æ ¼å¼å¯¼å…¥å¯¼å‡º
- âœ… **è‡ªåŠ¨åˆ·æ–°** - çŠ¶æ€ã€è¿æ¥å®æ—¶æ›´æ–°

#### ç”¨æˆ·ä½“éªŒ
- âœ… **é€€å‡ºç¡®è®¤** - é˜²æ­¢è¯¯æ“ä½œé€€å‡º
- âœ… **çŠ¶æ€åé¦ˆ** - æ“ä½œç»“æœå®æ—¶æç¤º
- âœ… **æ™ºèƒ½å¯¼èˆª** - å­é¡µé¢è¿”å› Homeï¼ŒHome è§¦å‘é€€å‡º
- âœ… **ä¸Šä¸‹æ–‡å¸®åŠ©** - æ¯ä¸ªé¡µé¢æ˜¾ç¤ºç›¸å…³å¿«æ·é”®

---

## å¿«é€Ÿå¼€å§‹

### å®‰è£…

#### ä»æºç ç¼–è¯‘

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/yourusername/clashctl.git
cd clashctl

# ç¼–è¯‘ Release ç‰ˆæœ¬
cargo build --release

# è¿è¡Œ
./target/release/clashctl
```

#### ç³»ç»Ÿè¦æ±‚

- Rust 1.70+
- è¿è¡Œä¸­çš„ Clash å†…æ ¸ï¼ˆmihomoã€clash-verge ç­‰ï¼‰
- Clash External Controller API å·²å¯ç”¨

### é¦–æ¬¡è¿è¡Œ

```bash
# å¦‚æœ Clash è¿è¡Œåœ¨é»˜è®¤ç«¯å£ï¼ˆ9090ï¼‰ï¼Œç›´æ¥å¯åŠ¨
./clashctl

# è‡ªå®šä¹‰ API åœ°å€å’Œå¯†é’¥
./clashctl --api-url http://127.0.0.1:9090 --secret your_secret

# é…ç½®ä¼šè‡ªåŠ¨ä¿å­˜åˆ° ~/.config/clashctl/config.yaml
# ä¸‹æ¬¡ç›´æ¥è¿è¡Œå³å¯
```

### 3 åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹

```
1. å¯åŠ¨ç¨‹åº â†’ Home é¡µé¢
2. æŒ‰ g â†’ è¿›å…¥ Routesï¼ˆçº¿è·¯ç®¡ç†ï¼‰
3. æŒ‰ t â†’ æ‰¹é‡æµ‹é€Ÿæ‰€æœ‰èŠ‚ç‚¹
4. æŒ‰ Enter â†’ å±•å¼€æŸ¥çœ‹èŠ‚ç‚¹åˆ—è¡¨
5. é€‰æ‹©æœ€å¿«èŠ‚ç‚¹ â†’ æŒ‰ Enter åˆ‡æ¢
6. å®Œæˆï¼æŒ‰ h è¿”å› Home
```

---

## ä½¿ç”¨æŒ‡å—

### é¡µé¢å¯¼èˆª

```
Home (ä¸»é¡µ)
 â”œâ”€â”€ g â†’ Routes (çº¿è·¯ç®¡ç†)
 â”œâ”€â”€ l â†’ Rules (è§„åˆ™ç®¡ç†)
 â”œâ”€â”€ c â†’ Connections (è¿æ¥ç›‘æ§)
 â”œâ”€â”€ s â†’ Settings (è®¾ç½®)
 â””â”€â”€ u â†’ Update (è®¢é˜…æ›´æ–°)
```

### Preset ç³»ç»Ÿ

æŒ‰ `Ctrl+P` åˆ‡æ¢ä¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼š

#### 1. Default - æ—¥å¸¸ä½¿ç”¨
```
â€¢ é»˜è®¤: Simple æ¨¡å¼
â€¢ åŠŸèƒ½: æ‰€æœ‰åŠŸèƒ½å¯ç”¨
â€¢ é€‚åˆ: æ™®é€šç”¨æˆ·æ—¥å¸¸ä½¿ç”¨
```

#### 2. Work - å·¥ä½œç¯å¢ƒ
```
â€¢ é»˜è®¤: Simple æ¨¡å¼
â€¢ åŠŸèƒ½: éšè—æ‰¹é‡æµ‹é€Ÿ
â€¢ é€‚åˆ: åŠå…¬ç¯å¢ƒï¼Œç•Œé¢ç®€æ´
```

#### 3. Strict - ç”Ÿäº§ç¯å¢ƒ
```
â€¢ é»˜è®¤: Simple æ¨¡å¼
â€¢ åŠŸèƒ½: éœ€ Expert æ¨¡å¼æ‰èƒ½åˆ‡æ¢èŠ‚ç‚¹
â€¢ é€‚åˆ: é˜²æ­¢è¯¯æ“ä½œçš„ç”Ÿäº§ç¯å¢ƒ
```

#### 4. Expert - é«˜çº§ç”¨æˆ·
```
â€¢ é»˜è®¤: Expert æ¨¡å¼
â€¢ åŠŸèƒ½: æ˜¾ç¤ºæ‰€æœ‰ç»†èŠ‚
â€¢ é€‚åˆ: ç†Ÿç»ƒç”¨æˆ·ã€è°ƒè¯•åœºæ™¯
```

### Simple vs Expert æ¨¡å¼

æŒ‰ `Ctrl+E` åœ¨ä¸¤ç§æ¨¡å¼é—´åˆ‡æ¢ï¼š

| ç‰¹æ€§ | Simple æ¨¡å¼ | Expert æ¨¡å¼ |
|------|------------|------------|
| ç›®æ ‡ç”¨æˆ· | åˆå­¦è€… | é«˜çº§ç”¨æˆ· |
| Routes é¡µé¢ | åªæ˜¾ç¤ºçº¿è·¯ | æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹ |
| Rules é¡µé¢ | ç™½åå•/é»‘åå• | å®Œæ•´è§„åˆ™åˆ—è¡¨ |
| ä¿¡æ¯å¯†åº¦ | ç²¾ç®€ | è¯¦ç»† |
| ä¸Šæ‰‹éš¾åº¦ | â­ | â­â­â­ |

---

## å¿«æ·é”®é€ŸæŸ¥

### å…¨å±€å¿«æ·é”®
```
q / Esc      è¿”å›/é€€å‡ºï¼ˆå­é¡µé¢è¿”å› Homeï¼ŒHome é¡µé¢é€€å‡ºï¼‰
Ctrl+C       å¼ºåˆ¶é€€å‡ºï¼ˆå¸¦ç¡®è®¤ï¼‰
h            å¿«é€Ÿè¿”å› Home
Ctrl+E       åˆ‡æ¢ Simple/Expert æ¨¡å¼
Ctrl+P       åˆ‡æ¢ Preset
```

### Home é¡µé¢
```
m            åˆ‡æ¢åœºæ™¯ (Rule â†’ Global â†’ Direct)
g            è·³è½¬ Routes
l            è·³è½¬ Rules
c            è·³è½¬ Connections
s            è·³è½¬ Settings
t            æµ‹è¯•å½“å‰èŠ‚ç‚¹é€Ÿåº¦
r            åˆ·æ–°çŠ¶æ€
```

### Routes é¡µé¢
```
â†‘â†“           å¯¼èˆª
Enter / â†’    å±•å¼€èŠ‚ç‚¹åˆ—è¡¨
*            æ”¶è—/å–æ¶ˆæ”¶è—èŠ‚ç‚¹
t            æ‰¹é‡æµ‹é€Ÿ
Esc / â†      è¿”å›çº¿è·¯åˆ—è¡¨
```

### Rules é¡µé¢ï¼ˆSimple æ¨¡å¼ï¼‰
```
w            æ·»åŠ ç™½åå•ï¼ˆAlways Proxyï¼‰
b            æ·»åŠ é»‘åå•ï¼ˆAlways Directï¼‰
d            åˆ é™¤é€‰ä¸­è§„åˆ™
â†‘â†“           å¯¼èˆª
```

### Connections é¡µé¢
```
â†‘â†“           å¯¼èˆª
d            å…³é—­é€‰ä¸­è¿æ¥
a            å…³é—­æ‰€æœ‰è¿æ¥
r            æ‰‹åŠ¨åˆ·æ–°
```

### Settings é¡µé¢
```
e            å¯¼å‡ºé…ç½®åˆ° YAML
i            å¯¼å…¥é…ç½®ä» YAML
y/n          ç¡®è®¤/å–æ¶ˆ
```

å®Œæ•´å¿«æ·é”®å‚è€ƒï¼š[docs/KEYBOARD_SHORTCUTS.md](docs/KEYBOARD_SHORTCUTS.md)

---

## é…ç½®æ–‡ä»¶

### é…ç½®ä½ç½®

```
~/.config/clashctl/config.yaml
```

### é…ç½®ç¤ºä¾‹

```yaml
api_url: http://127.0.0.1:9090
secret: your_secret_here
default_mode: simple
current_preset: default

# æ”¶è—çš„èŠ‚ç‚¹
favorite_nodes:
  - "HK 01"
  - "US 02"

# ç™½åå•ï¼ˆAlways Proxyï¼‰
whitelist:
  - google.com
  - github.com

# é»‘åå•ï¼ˆAlways Directï¼‰
blacklist:
  - example.com
  - local.dev
```

### é…ç½®ä¼˜å…ˆçº§

```
CLI å‚æ•° > é…ç½®æ–‡ä»¶ > é»˜è®¤å€¼
```

---

## å¼€å‘æ–‡æ¡£

### é¡¹ç›®ç»“æ„

```
clashctl/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/              # åº”ç”¨é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ mod.rs        # æ¨¡å¼å®šä¹‰
â”‚   â”‚   â””â”€â”€ state.rs      # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ clash/            # Clash API
â”‚   â”‚   â”œâ”€â”€ client.rs     # API å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ types.rs      # æ•°æ®ç±»å‹
â”‚   â”‚   â””â”€â”€ models.rs     # é¢†åŸŸæ¨¡å‹
â”‚   â”œâ”€â”€ config/           # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ mod.rs        # é…ç½®è¯»å†™
â”‚   â”‚   â””â”€â”€ preset.rs     # Preset ç³»ç»Ÿ
â”‚   â”œâ”€â”€ ui/               # ç”¨æˆ·ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ mod.rs        # UI ä¸»å¾ªç¯
â”‚   â”‚   â””â”€â”€ pages/        # é¡µé¢ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ home.rs
â”‚   â”‚       â”œâ”€â”€ routes.rs
â”‚   â”‚       â”œâ”€â”€ rules.rs
â”‚   â”‚       â”œâ”€â”€ connections.rs
â”‚   â”‚       â””â”€â”€ settings.rs
â”‚   â””â”€â”€ main.rs           # ç¨‹åºå…¥å£
â””â”€â”€ docs/                 # æ–‡æ¡£
```

### æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Rust 1.70+
- **TUI æ¡†æ¶**: ratatui 0.26
- **ç»ˆç«¯æ§åˆ¶**: crossterm 0.27
- **å¼‚æ­¥è¿è¡Œæ—¶**: tokio 1.x
- **HTTP å®¢æˆ·ç«¯**: reqwest 0.11
- **åºåˆ—åŒ–**: serde + serde_json + serde_yaml

### å¼€å‘æŒ‡å—

è¯¦ç»†å¼€å‘æ–‡æ¡£ï¼š
- [å¼€å‘è·¯çº¿å›¾](docs/DEVELOPMENT_ROADMAP.md)
- [å®ç°æ€»ç»“](docs/IMPLEMENTATION_SUMMARY.md)
- [åŠŸèƒ½æ€»ç»“](docs/FEATURES_SUMMARY.md)
- [æœ€ç»ˆæŠ¥å‘Š](docs/FINAL_PROJECT_REPORT.md)

---

## æ€§èƒ½æŒ‡æ ‡

- **ç¼–è¯‘æ—¶é—´**: 4.6s (release)
- **äºŒè¿›åˆ¶å¤§å°**: ~2MB (stripped)
- **å†…å­˜å ç”¨**: 10-20MB
- **CPU ç©ºé—²**: <1%
- **å¯åŠ¨æ—¶é—´**: <1s

---

## å¸¸è§é—®é¢˜

### Q: æ— æ³•è¿æ¥åˆ° Clash
**A**: æ£€æŸ¥ä»¥ä¸‹é¡¹ï¼š
1. Clash æ˜¯å¦æ­£åœ¨è¿è¡Œ
2. External Controller æ˜¯å¦å¯ç”¨ï¼ˆé€šå¸¸åœ¨ Clash é…ç½®çš„ `external-controller: 127.0.0.1:9090`ï¼‰
3. API åœ°å€å’Œå¯†é’¥æ˜¯å¦æ­£ç¡®
4. é˜²ç«å¢™æ˜¯å¦é˜»æ­¢è¿æ¥

### Q: ä¸ºä»€ä¹ˆæŒ‰ q ä¸é€€å‡ºï¼Ÿ
**A**: åœ¨å­é¡µé¢ï¼ˆRoutes/Rules ç­‰ï¼‰ï¼Œ`q` è¿”å› Homeã€‚åªæœ‰åœ¨ Home é¡µé¢æŒ‰ `q` æ‰è§¦å‘é€€å‡ºç¡®è®¤ã€‚

### Q: æµ‹é€ŸåŠŸèƒ½ä¸å¯ç”¨
**A**: æŸäº› Presetï¼ˆå¦‚ Workï¼‰ä¼šéšè—æµ‹é€ŸåŠŸèƒ½ã€‚æŒ‰ `Ctrl+P` åˆ‡æ¢åˆ°å…¶ä»– Presetã€‚

### Q: æ— æ³•åˆ‡æ¢èŠ‚ç‚¹
**A**: å¦‚æœä½¿ç”¨ Strict Presetï¼Œéœ€è¦å…ˆæŒ‰ `Ctrl+E` åˆ‡æ¢åˆ° Expert æ¨¡å¼ã€‚

### Q: é…ç½®æ–‡ä»¶æŸå
**A**: åˆ é™¤ `~/.config/clashctl/config.yaml`ï¼Œé‡æ–°å¯åŠ¨ç¨‹åºä¼šè‡ªåŠ¨åˆ›å»ºæ–°é…ç½®ã€‚

æ›´å¤šé—®é¢˜ï¼š[docs/FAQ.md](docs/FAQ.md)

---

## è·¯çº¿å›¾

### âœ… å·²å®Œæˆï¼ˆv0.1.0ï¼‰

- Phase 0-6: åŸºç¡€åŠŸèƒ½ + MVP
- Phase 8-9: é…ç½®æŒä¹…åŒ– + Preset ç³»ç»Ÿ
- Phase 11.1-11.2: è§„åˆ™æœç´¢ + ç¼–è¾‘
- Phase 12: è¿æ¥ç®¡ç†
- Phase 16: èŠ‚ç‚¹æ”¶è—
- Phase 18: é…ç½®å¯¼å…¥/å¯¼å‡º

### ğŸ”„ è®¡åˆ’ä¸­

- Phase 13: æ—¥å¿—æŸ¥çœ‹ï¼ˆéœ€è¦ WebSocketï¼‰
- Phase 14: è‡ªå®šä¹‰èŠ‚ç‚¹åˆ†ç»„
- Phase 15: æ€§èƒ½ç›‘æ§å›¾è¡¨
- Phase 17: ä¸»é¢˜ç³»ç»Ÿ

---

## è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ”¹åŠ¨ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### å¼€å‘åŸåˆ™

- ä¿æŒ"ç®€å•ä¼˜å…ˆ"ç†å¿µ
- Simple æ¨¡å¼åŠŸèƒ½ â‰¤ 7 ä¸ªå¯æ“ä½œé¡¹
- æ–°åŠŸèƒ½å¿…é¡»æœ‰å¯¹åº”å¿«æ·é”®
- æ‰€æœ‰ I/O æ“ä½œå¿…é¡»å¼‚æ­¥éé˜»å¡

---

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

## è‡´è°¢

- [ratatui](https://github.com/ratatui-org/ratatui) - ä¼˜ç§€çš„ TUI æ¡†æ¶
- [Clash](https://github.com/Dreamacro/clash) - å¼ºå¤§çš„ä»£ç†å·¥å…·
- [mihomo](https://github.com/MetaCubeX/mihomo) - Clash å†…æ ¸åˆ†æ”¯

---

## è”ç³»æ–¹å¼

- **Issues**: [GitHub Issues](https://github.com/yourusername/clashctl/issues)
- **Discussions**: [GitHub Discussions](https://github.com/yourusername/clashctl/discussions)

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Starï¼**

Made with â¤ï¸ in Rust

</div>
